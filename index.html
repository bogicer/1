<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Онлайн Газета</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {font-family: Arial, sans-serif; margin:0; background:#f9f9f9; color:#222;}
    header {background:#2b2d42; color:#fff; padding:15px;}
    header h1 {margin:0;}
    nav a {color:#fff; margin-right:15px; text-decoration:none; font-weight:bold;}
    nav a:hover {text-decoration:underline;}
    main {padding:20px; max-width:900px; margin:auto;}
    .article {background:#fff; padding:15px; margin-bottom:15px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,.1);}
    .article h2 {margin:0 0 10px;}
    .meta {font-size:12px; color:#666; margin-bottom:10px;}
    .article img {max-width:100%; border-radius:6px; margin:10px 0;}
    #cabinet {display:none;}
    form {display:grid; gap:10px; margin-top:10px;}
    input, textarea {padding:10px; font-size:14px; border:1px solid #ccc; border-radius:6px;}
    button {padding:10px; border:none; border-radius:6px; background:#2b2d42; color:#fff; cursor:pointer;}
    button:hover {background:#3c3f60;}
    .delete-btn {background:#d90429; margin-top:10px;}
    .delete-btn:hover {background:#a3021f;}
    .edit-btn {background:#f77f00; margin-left:10px;}
    .edit-btn:hover {background:#c76500;}
    .clear-btn {background:#ef233c; margin-top:15px;}
    .clear-btn:hover {background:#a3021f;}
  </style>
</head>
<body>

<header>
  <h1>Онлайн Газета</h1>
  <nav>
    <a href="#" onclick="showPage('home')">Головна</a>
    <a href="#" onclick="showPage('cabinet')">Кабінет</a>
  </nav>
</header>

<main>
  <!-- Головна -->
  <section id="home">
    <h2>Останні статті</h2>
    <div id="articles"></div>
  </section>

  <!-- Кабінет -->
  <section id="cabinet">
    <h2 id="formTitle">Додати статтю</h2>
    <form id="articleForm">
      <input type="text" id="title" placeholder="Заголовок" required>
      <textarea id="content" placeholder="Текст статті" rows="6" required></textarea>
      <input type="text" id="author" placeholder="Автор" required>
      <input type="file" id="image" accept="image/*">
      <button type="submit">Опублікувати</button>
    </form>
    <button class="clear-btn" onclick="clearArticles()">Очистити всі статті</button>
  </section>
</main>

<script>
  let editIndex = null;

  // Перемикання сторінок
  function showPage(page) {
    document.getElementById("home").style.display = (page === "home") ? "block" : "none";
    document.getElementById("cabinet").style.display = (page === "cabinet") ? "block" : "none";
  }
  showPage("home");

  // Завантаження статей
  function loadArticles() {
    let articles = JSON.parse(localStorage.getItem("articles")) || [];
    let container = document.getElementById("articles");
    container.innerHTML = "";
    if (articles.length === 0) {
      container.innerHTML = "<p>Статей ще немає. Додайте першу!</p>";
      return;
    }
    articles.forEach((a, i) => {
      let div = document.createElement("div");
      div.className = "article";
      div.innerHTML = `
        <h2>${a.title}</h2>
        <div class="meta">Автор: <b>${a.author}</b> | Опубліковано: ${a.time}</div>
        ${a.image ? `<img src="${a.image}" alt="Зображення">` : ""}
        <p>${a.content}</p>
        <button class="delete-btn" onclick="deleteArticle(${i})">Видалити</button>
        <button class="edit-btn" onclick="editArticle(${i})">Редагувати</button>
      `;
      container.appendChild(div);
    });
  }

  // Збереження статті
  document.getElementById("articleForm").addEventListener("submit", function(e) {
    e.preventDefault();
    let title = document.getElementById("title").value;
    let content = document.getElementById("content").value;
    let author = document.getElementById("author").value;
    let file = document.getElementById("image").files[0];
    let time = new Date().toLocaleString("uk-UA");

    if (file) {
      let reader = new FileReader();
      reader.onload = function(event) {
        saveArticle(title, content, author, time, event.target.result);
      };
      reader.readAsDataURL(file);
    } else {
      saveArticle(title, content, author, time, null);
    }
  });

  // Збереження / редагування статті
  function saveArticle(title, content, author, time, image) {
    let articles = JSON.parse(localStorage.getItem("articles")) || [];

    if (editIndex !== null) {
      articles[editIndex] = {title, content, author, time, image: image || articles[editIndex].image};
      editIndex = null;
      document.getElementById("formTitle").textContent = "Додати статтю";
    } else {
      articles.unshift({title, content, author, time, image});
    }

    localStorage.setItem("articles", JSON.stringify(articles));
    document.getElementById("articleForm").reset();
    showPage("home");
    loadArticles();
  }

  // Видалення
  function deleteArticle(index) {
    let articles = JSON.parse(localStorage.getItem("articles")) || [];
    if (confirm("Видалити цю статтю?")) {
      articles.splice(index, 1);
      localStorage.setItem("articles", JSON.stringify(articles));
      loadArticles();
    }
  }

  // Очистити всі
  function clearArticles() {
    if (confirm("Ви впевнені, що хочете видалити всі статті?")) {
      localStorage.removeItem("articles");
      loadArticles();
      alert("Всі статті видалені!");
    }
  }

  // Редагування
  function editArticle(index) {
    let articles = JSON.parse(localStorage.getItem("articles")) || [];
    let a = articles[index];
    document.getElementById("title").value = a.title;
    document.getElementById("content").value = a.content;
    document.getElementById("author").value = a.author;
    editIndex = index;
    document.getElementById("formTitle").textContent = "Редагувати статтю";
    showPage("cabinet");
  }

  // Перший рендер
  loadArticles();
</script>

</body>
</html>
